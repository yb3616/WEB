<template>
    <v-content>
        <v-container fluid fill-height>
            <v-layout align-center justify-center>
                <v-flex xs12 sm8 md4>
                    <v-card class="elevation-12">
                        <v-toolbar dark color="primary">
                            <v-toolbar-title>注册账号</v-toolbar-title>
                            <v-spacer></v-spacer>
                            <v-btn large flat to="/login">登录</v-btn>
                        </v-toolbar>
                        <v-card-text>
                            <v-form ref="form">
                                <v-text-field
                                    :rules="usernameRules"
                                    v-model="user_name"
                                    label="登录账号"
                                    required
                                    single-line
                                    clearable
                                    ></v-text-field>
                                <v-text-field
                                    :rules="phoneRules"
                                    v-model="phone"
                                    label="手机号码"
                                    required
                                    single-line
                                    clearable
                                    ></v-text-field>
                                <v-text-field
                                    :rules="emailRules"
                                    v-model="email"
                                    label="邮箱账号"
                                    required
                                    single-line
                                    clearable
                                    ></v-text-field>
                                <v-text-field
                                    :append-icon="e1 ? 'visibility' : 'visibility_off'"
                                    :append-icon-cb="() => (e1 = !e1)"
                                    :type="!e1 ? 'password' : 'text'"
                                    v-model="password"
                                    label="登录密码"
                                    :rules="pwdRules"
                                    single-line
                                    required
                                    ></v-text-field>
                                <v-text-field
                                    :append-icon="e2 ? 'visibility' : 'visibility_off'"
                                    :append-icon-cb="() => (e2 = !e2)"
                                    :type="!e2 ? 'password' : 'text'"
                                    label="重复密码"
                                    v-model="password2"
                                    :rules="[() => !!password2 || '必须填入密码', () => password2.length >= 6 || '最少六位密码', () => password == password2 || '两次密码不一致' ]"
                                    single-line
                                    required
                                    ></v-text-field>
                            </v-form>
                        </v-card-text>
                        <v-card-actions>
                            <v-spacer></v-spacer>
                            <v-btn flat @click="logon">注册</v-btn>
                        </v-card-actions>
                    </v-card>
                </v-flex>
            </v-layout>
        </v-container>
    </v-content>
</template>

<script>
export default {
    data: () => ({
        email: '',
        user_name: '',
        phone: '',
        password: '',
        password2: '',
        e1: false,
        e2: false,
        usernameRules:[ (v) => !!v || '必须填入登录账号', (v) => /^[a-zA-Z]+\w{3,}$/.test(v) || '登录账号格式不正确' ],
        phoneRules:[ (v) => !!v || '必须输入手机号码', (v) => /^1\d{10}$/.test(v) || '手机号码格式不正确' ],
        emailRules:[ (v) => !!v || '必须填入邮箱', (v) => /^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(v) || '邮箱格式不正确' ],
        pwdRules:[ v => !!v || '必须填入密码', v => v.length >= 6 || '最少六位密码' ],
    }),
    methods: {
        logon: function() {
            if (this.$refs.form.validate()) {
                this.$http.post("/logon", {
                    user_name: this.user_name,
                    email: this.email,
                    phone: this.phone,
                    password: this.password,
                })
                    .then(function(resp) {
                        console.log(resp);
                    })
                    .catch(function(err) {
                        console.log(err);
                    })
            }
        }
    },
    mounted() {
    },
};
</script>
